# Инструкция по настройке и запуску

## Быстрый старт

Проект уже настроен и готов к работе! Все зависимости установлены.

### 1. Запуск веб-сервера

```bash
source .venv/bin/activate
python -c "from app.server import run; run(port=5001)"
```

Откройте браузер: http://127.0.0.1:5001/

### 2. Использование через CLI (без LLM)

```bash
source .venv/bin/activate
python app/screenplay_parser.py -i input/test_scenario.docx -o output/result.xlsx --no-llm
```

## Работа с LLM (опционально)

Для улучшения качества парсинга можно использовать локальную LLM модель.

### Загрузка модели

```bash
./download_model.sh
```

Это загрузит модель Mistral 7B (~4.1 GB). Загрузка займет несколько минут.

### Использование с LLM

После загрузки модели:

```bash
source .venv/bin/activate
python app/screenplay_parser.py -i input/test_scenario.docx -o output/result.xlsx
```

Или через веб-интерфейс - включите опцию "Использовать LLM" при загрузке файла.

## Что уже работает

✅ Виртуальное окружение создано (`.venv`)
✅ Все библиотеки установлены
✅ Папки созданы (`models`, `output`, `logs`, `input`)
✅ Веб-сервер работает на порту 5001
✅ Парсинг сценариев без LLM работает
✅ Экспорт в Excel/CSV/JSON работает

## Тестовый файл

Создан тестовый сценарий: `input/test_scenario.docx`
Результат парсинга: `output/test_result.xlsx`

## Структура проекта

```
WinkHackathon/
├── .venv/                  # Виртуальное окружение
├── app/
│   ├── __init__.py        # Инициализация пакета
│   ├── server.py          # Flask веб-сервер
│   ├── screenplay_parser.py  # Основной парсер
│   └── llm.py             # Альтернативная реализация
├── models/                # Папка для LLM моделей
├── output/                # Результаты парсинга
├── input/                 # Входные файлы
├── logs/                  # Логи
├── preprod-enterprise.html  # Веб-интерфейс
├── requirements.txt       # Зависимости
├── download_model.sh      # Скрипт загрузки модели
└── README.md             # Основная документация

```

## Возможности

### Парсинг сценариев
- Чтение .docx и .pdf файлов
- Автоматическое разбиение на сцены
- Извлечение метаданных:
  - Локации и подлокации
  - Персонажи
  - Время суток (день/ночь/утро/вечер)
  - Реквизит
  - Транспорт
  - Массовка
  - Спецэффекты
  - Трюки и пиротехника

### Экспорт
- Excel (.xlsx) с форматированием
- CSV
- JSON

### Режимы работы
- **Без LLM** - быстрый парсинг по правилам
- **С LLM** - улучшенное извлечение метаданных

## Порты

- Веб-сервер: http://127.0.0.1:5001/
- (Порт 5000 может быть занят AirPlay на macOS)

## Остановка сервера

Нажмите `Ctrl+C` в терминале где запущен сервер.