# Конфигурация для извлечения сущностей из сценариев
# Определяет типы сущностей и пресеты для анализа

# Типы извлекаемых сущностей
entity_types:
  location:
    description: "Основная локация сцены (например: квартира, улица, офис)"
    type: "string"
    required: true
    
  sublocation:
    description: "Подобъект или уточнение локации (например: кухня, спальня)"
    type: "string"
    required: false
    
  time_of_day:
    description: "Время суток (ДЕНЬ, НОЧЬ, УТРО, ВЕЧЕР, РАССВЕТ, ЗАКАТ)"
    type: "string"
    required: true
    
  scene_type:
    description: "Тип сцены (ИНТ, ЭКСТ, НАТ)"
    type: "string"
    required: true
    
  characters:
    description: "Список персонажей, участвующих в сцене"
    type: "list"
    required: true
    
  props:
    description: "Детальный список реквизита с характеристиками (цвет, размер, состояние, количество). Например: 'телефон Nokia 3310', 'бутылка плодового вина', 'пустые бутылки (5 шт)', 'мокрая одежда', 'разбитый телефон'. Указывай ВСЕ предметы из текста."
    type: "list"
    required: false
    
  vehicles:
    description: "Детальное описание игрового транспорта с моделью и цветом. Примеры: 'бобик - советский джип', '412 красный москвич', 'черная Волга ГАЗ-24', 'велосипед', 'мотоцикл Урал'. Указывай модель и цвет если упомянуты."
    type: "list"
    required: false
    
  crowd:
    description: "Описание массовки: кто именно присутствует в сцене как фон (например: 'толпа прохожих', 'студенты в аудитории', 'официанты в ресторане'). Если массовки нет, верни пустую строку."
    type: "string"
    required: false
    
  crowd_count:
    description: "Точное количество людей в массовке (только число, без текста). Например, если в тексте 'толпа из 20 человек' или 'массовка: 15 человек', верни 20 или 15 соответственно. Если количество не указано явно, верни 0."
    type: "integer"
    required: false
    
  vfx:
    description: "Визуальные спецэффекты с деталями. Примеры: 'туман', 'дым', 'искры от сварки', 'разбитое стекло', 'кровь (имитация)', 'взрыв (пиротехника)'. Указывай все эффекты из текста."
    type: "list"
    required: false
    
  sfx:
    description: "Звуковые эффекты"
    type: "list"
    required: false
    
  costumes:
    description: "Детальное описание костюмов с характеристиками (цвет, стиль, состояние). Примеры: 'деловой костюм серый', 'вечернее платье красное', 'форма полицейского', 'мокрая одежда', 'грязная рубашка', 'костюм в крови', 'порванная куртка'. Указывай состояние если упомянуто."
    type: "list"
    required: false
    
  makeup:
    description: "Детальные требования к гриму и макияжу. Примеры: 'разбитая губа', 'синяк под глазом', 'кровь на лице', 'старение +20 лет', 'шрам на щеке', 'бледность', 'усталый вид', 'грязь на лице'. Указывай ВСЕ детали грима из текста."
    type: "list"
    required: false
    
  stunts:
    description: "Наличие трюков/каскадеров (true/false)"
    type: "boolean"
    required: false
    
  pyrotechnics:
    description: "Наличие пиротехники (true/false)"
    type: "boolean"
    required: false
    
  special_equipment:
    description: "Специальное техническое оборудование для съемки: камеры на кранах, дроны, стабилизаторы, специальные осветительные приборы, микрофоны на журавлях, операторские тележки и т.д. НЕ включай обычный реквизит, костюмы или грим. Только профессиональное съемочное оборудование. Если такого оборудования нет, верни пустой список."
    type: "list"
    required: false
    
  notes:
    description: "Дополнительные примечания к сцене"
    type: "string"
    required: false

# Пресеты - предопределенные наборы сущностей
presets:
  basic:
    name: "Базовый"
    description: "Минимальный набор полей для КПП"
    entities:
      - location
      - sublocation
      - time_of_day
      - scene_type
      - characters
      
  extended:
    name: "Расширенный"
    description: "Расширенный набор с реквизитом и эффектами"
    entities:
      - location
      - sublocation
      - time_of_day
      - scene_type
      - characters
      - props
      - vehicles
      - crowd
      - crowd_count
      - vfx
      
  full:
    name: "Полный"
    description: "Полный набор всех доступных сущностей"
    entities:
      - location
      - sublocation
      - time_of_day
      - scene_type
      - characters
      - props
      - vehicles
      - crowd
      - crowd_count
      - vfx
      - sfx
      - costumes
      - makeup
      - stunts
      - pyrotechnics
      - special_equipment
      - notes

# Настройки LLM
llm:
  # Используемая модель (путь к локальной модели или имя из HuggingFace)
  # Для GPU 24GB оптимальные модели:
  # - "Qwen/Qwen2.5-14B-Instruct" (отличное качество, ~8-9GB) - РЕКОМЕНДУЕТСЯ для 24GB
  # - "Qwen/Qwen2.5-7B-Instruct" (быстрее, ~4-5GB) - запасной вариант
  # - "mistralai/Mistral-7B-Instruct-v0.3" (быстро, ~4-5GB) - если Qwen недоступна
  model_name: "mistralai/Mistral-7B-Instruct-v0.3"
  
  # Использование vllm для оптимизации (РЕКОМЕНДУЕТСЯ для 24GB)
  use_vllm: false
  
  # Устройство для инференса
  device: "cuda"  # "cuda" или "cpu"
  
  generation:
    max_new_tokens: 2024
    temperature: 0.001  # Низкая температура для точности
    top_p: 0.9
    top_k: 40
    do_sample: true
    
  # Батчевая обработка
  batch:
    scene_detection_batch_size: 20
    entity_extraction_batch_size: 6
  
  # Использование flash attention (если доступно)
  use_flash_attention: true

# Настройки парсинга
parsing:
  min_scene_length: 50
  max_scene_length: 5000
  scene_detection_confidence_threshold: 0.7

